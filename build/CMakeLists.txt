PROJECT(vdb)
CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

SET(VDB_VERSION_MAJOR 1)
SET(VDB_VERSION_MINOR 2)
STRING(TIMESTAMP VDB_VERSION_DATE "%Y-%m-%d %H:%M")
SET(VDB_SOURCE_PATH ../source)
SET(VDIS_SOURCE_PATH ../vdis)
SET(CMAKE_BUILD_TYPE Debug)
SET(CMAKE_CXX_FLAGS "-g -std=c++0x -Wall")
SET(EXECUTABLE_OUTPUT_PATH ../)
SET(PCAP_PATH libpcap-1.7.4)

CONFIGURE_FILE(
    ${VDB_SOURCE_PATH}/vdb_version.h.in
    ${VDB_SOURCE_PATH}/vdb_version.h
)

# This is needed to suppress the "relative path" warning for the 
# LINK_DIRECTORIES command...
CMAKE_POLICY(SET CMP0015 NEW)

LINK_DIRECTORIES(${PCAP_PATH})

FILE(GLOB VDIS_SOURCES ${VDIS_SOURCE_PATH}/*.cpp)
FILE(GLOB VDIS_TEST_SOURCES ${VDIS_SOURCE_PATH}/test/*.cpp)
FILE(GLOB VDB_SOURCES ${VDB_SOURCE_PATH}/*.cpp)

ADD_LIBRARY(vdis STATIC ${VDIS_SOURCES})
ADD_EXECUTABLE(vdis_test ${VDIS_TEST_SOURCES})
TARGET_LINK_LIBRARIES(vdis_test vdis)
TARGET_INCLUDE_DIRECTORIES(
    vdis PUBLIC
    ${VDIS_SOURCE_PATH}
    ${VDIS_SOURCE_PATH}/enumerations
)

ADD_EXECUTABLE(vdb ${VDB_SOURCES})
TARGET_LINK_LIBRARIES(vdb vdis pcap)
TARGET_INCLUDE_DIRECTORIES(
    vdb PUBLIC
    ${PCAP_PATH}
    ${VDB_SOURCE_PATH}
    ${VDIS_SOURCE_PATH}
    ${VDIS_SOURCE_PATH}/enumerations
)
